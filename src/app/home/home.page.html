<ion-header>
  <ion-toolbar color="secondary">
    <ion-title>
      All Tasks
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div *ngIf="md.filteredTasks && md.filteredTasks.length; else noTasks">
    <ion-searchbar showCancelButton="focus" [(ngModel)]="searchTerm"></ion-searchbar>

    <ion-list>
      <ion-radio-group value="none">
        <ion-list-header class="ion-no-padding">
          <ion-label>Complete/incomplete filter</ion-label>
        </ion-list-header>
        <ion-item class="ion-no-padding" (ionFocus)="completeFilter(true)">
          <ion-label>True</ion-label>
          <ion-radio color="secondary" value="true" slot="start"></ion-radio>
        </ion-item>
        <ion-item class="ion-no-padding" (ionFocus)="completeFilter(false)">
          <ion-label>False</ion-label>
          <ion-radio color="secondary" value="false" slot="start"></ion-radio>
        </ion-item>
        <ion-item class="ion-no-padding" (ionFocus)="completeFilter()">
          <ion-label>None</ion-label>
          <ion-radio color="secondary" value="none" slot="start"></ion-radio>
        </ion-item>
      </ion-radio-group>
    </ion-list>

    <div style="overflow-x:auto;" *ngIf="md.filteredTasks && md.filteredTasks.length">
      <table class="ion-margin-top">
        <tr>
          <th *ngFor="let column of displayedColumns" (click)="getOrderedTasks(column)">
            <i *ngIf="column" class="fa fa-fw fa-sort"></i>{{column}}
          </th>
        </tr>
        <tr *ngFor="let task of md.filteredTasks | searchTask:searchTerm; let i = index"
          [ngStyle]="{'background-color': task.isSelected ? '#f2f2f2' : '#ffffff'}">
          <td class="ion-text-center multiple-select">
            <ion-checkbox color="secondary" (click)="selectItem(i, task)"></ion-checkbox>
          </td>
          <td>{{task.title}}</td>
          <td>{{task.description}}</td>
          <td>{{task.completed}}</td>
          <td>{{formatDate(task.created)}}</td>
          <td class="ion-text-center">
            <ion-button color="secondary" size="small" (click)="gotoEditTask(task.id)">
              <ion-icon slot="icon-only" name="create"></ion-icon>
            </ion-button>
            <ion-button color="danger" size="small" (click)="deleteTask(task)">
              <ion-icon slot="icon-only" name="trash"></ion-icon>
            </ion-button>
          </td>
        </tr>
      </table>
    </div>
    <div class="pagination ion-margin-top">
      <a (click)="prevPage()">&laquo;</a>
      <a (click)="nextPage()">&raquo;</a>
    </div>
  </div>
  <ng-template #noTasks>
    <ion-grid class="grid">
      <ion-row class="ion-text-center" text-center>
        <h2 text-center>
          No tasks to do!
        </h2>
      </ion-row>
    </ion-grid>
  </ng-template>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed" (click)="gotoAddTask()">
    <ion-fab-button color="secondary">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>

<ion-footer *ngIf="hasSelection">
  <ion-toolbar>
    <ion-button class="ion-margin-top" color="danger" expand="full" type="submit" (click)="deleteTasks()">
      Delete</ion-button>
  </ion-toolbar>
</ion-footer>